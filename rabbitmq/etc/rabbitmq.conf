# RabbitMQ 配置文件
# 参考文档: https://www.rabbitmq.com/configure.html

# ========================================
# 内存管理
# ========================================
# 内存高水位标记 (0.6 = 60%)
# 当内存使用超过此值时，RabbitMQ 会阻塞生产者
vm_memory_high_watermark.relative = 0.6

# 内存高水位分页阈值 (0.5 = 50%)
# 当内存使用超过此值时，队列开始将消息分页到磁盘
vm_memory_high_watermark_paging_ratio = 0.5

# ========================================
# 磁盘管理
# ========================================
# 磁盘最小空闲空间 (2GB)
# 当磁盘可用空间低于此值时，RabbitMQ 会阻塞生产者
disk_free_limit.absolute = 2GB

# ========================================
# 网络和连接
# ========================================
# 心跳超时 (60秒)
heartbeat = 60

# 通道最大数量限制
channel_max = 2048

# 帧最大大小 (128KB)
frame_max = 131072

# ========================================
# 日志配置
# ========================================
# 日志级别: debug, info, warning, error, critical, none
log.console.level = info
log.file.level = info

# 日志文件
log.file = /var/log/rabbitmq/rabbitmq.log

# 日志文件轮转
log.file.rotation.date = $D0
log.file.rotation.size = 10485760
log.file.rotation.count = 5

# ========================================
# 集群配置
# ========================================
# 集群节点类型: disc (磁盘节点) 或 ram (内存节点)
# 默认为 disc
# cluster_formation.node_type = disc

# ========================================
# 队列配置
# ========================================
# 默认队列类型: classic, quorum, stream
# queue_master_locator = min-masters

# ========================================
# 管理插件配置
# ========================================
# 管理界面刷新间隔 (5秒)
management.rates_mode = basic

# 管理界面统计数据保留时间
# management.sample_retention_policies.global.minute = 5
# management.sample_retention_policies.global.hour = 60
# management.sample_retention_policies.global.day = 1200

# ========================================
# 性能优化
# ========================================
# 消费者预取数量 (建议根据实际情况调整)
# consumer_timeout = 1800000

# 队列索引嵌入阈值
# queue_index_embed_msgs_below = 4096

# ========================================
# 其他配置
# ========================================
# 默认用户和密码（通过环境变量设置，见 compose.yaml）
# default_vhost = /
# default_user = admin
# default_pass = changeme

