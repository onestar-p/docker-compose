# RabbitMQ 环境变量配置示例
# 使用方法：复制此文件为 .env
# cp env.example .env

# ========================================
# 基础配置
# ========================================
RABBITMQ_VHOST=cw_platform_test
RABBITMQ_USER=admin
RABBITMQ_PASS=rabbitmq123456

# ========================================
# 重试策略配置（全局默认）
# 所有队列都会自动继承这些配置
# ========================================

# 最大重试次数（在消费者代码中使用此值）
# 推荐值：3-5
RABBITMQ_MAX_RETRIES=3

# 消息过期时间（毫秒）
# 默认 3600000ms = 1小时
# 1小时 = 3600000
# 2小时 = 7200000
# 24小时 = 86400000
RABBITMQ_MESSAGE_TTL=3600000

# 队列最大长度（防止队列无限增长）
# 建议根据业务量调整
RABBITMQ_MAX_LENGTH=100000

# 死信交换机名称
# 所有失败的消息都会发送到这里
RABBITMQ_DLX_EXCHANGE=dlx.exchange

# 死信队列名称
# 用于存储最终失败的消息
RABBITMQ_DLX_QUEUE=dlx.queue

# ========================================
# 使用说明
# ========================================
# 1. RabbitMQ 启动时会自动创建死信交换机和死信队列
# 2. 所有队列会自动应用策略：
#    - dead-letter-exchange: ${RABBITMQ_DLX_EXCHANGE}
#    - message-ttl: ${RABBITMQ_MESSAGE_TTL}
#    - max-length: ${RABBITMQ_MAX_LENGTH}
# 3. 重试次数需要在消费者代码中通过检查 x-death header 实现
# 4. 修改配置后需要重新构建镜像：
#    docker-compose -f rabbitmq/compose.yaml up -d --build

